# Data Model: Physical AI & Humanoid Robotics Textbook

**Feature**: 001-textbook-generation
**Date**: 2025-12-09
**Phase**: 1 (Design & Architecture)
**Input**: Research findings from `/specs/001-textbook-generation/research.md`

## Overview

This document defines the data models for the Physical AI & Humanoid Robotics textbook generation system. The data model encompasses both the content structure for the textbook itself and the synthetic data generated by Isaac Sim for training and validation purposes. The model is designed to support the 10 pedagogical principles from the Constitution while enabling efficient generation, storage, and retrieval of educational content and synthetic datasets.

## Core Entities

### 1. Textbook Entity

The Textbook entity represents the complete educational resource:

```yaml
Textbook:
  id: UUID (primary key)
  title: string
  subtitle: string
  edition: string
  publication_date: ISO 8601 date
  authors: [Author]
  modules: [Module]
  learning_objectives: [string]
  target_audience: string
  prerequisites: [string]
  estimated_completion_time: integer (hours)
  accessibility_compliance: string (WCAG level)
  license: string
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
  status: enum (draft, review, published, archived)
```

### 2. Module Entity

A Module represents a coherent section of the textbook:

```yaml
Module:
  id: UUID (primary key)
  textbook_id: UUID (foreign key to Textbook)
  title: string
  subtitle: string
  position: integer (order in textbook)
  description: string
  learning_objectives: [string]
  prerequisites: [string]
  estimated_completion_time: integer (hours)
  chapters: [Chapter]
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 3. Chapter Entity

A Chapter represents an individual learning unit:

```yaml
Chapter:
  id: UUID (primary key)
  module_id: UUID (foreign key to Module)
  title: string
  subtitle: string
  position: integer (order in module)
  learning_objectives: [string]
  theory_content: string (Markdown format)
  practice_content: string (Markdown format)
  active_exercises: [Exercise]
  worked_examples: [Example]
  assessments: [Assessment]
  diagrams: [Diagram]
  citations: [Citation]
  code_examples: [CodeExample]
  keywords: [string]
  difficulty_level: enum (beginner, intermediate, advanced)
  estimated_reading_time: integer (minutes)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 4. Exercise Entity

An Exercise represents an active learning activity:

```yaml
Exercise:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  description: string
  type: enum (hands_on, conceptual, implementation, analysis)
  difficulty: enum (easy, medium, hard)
  instructions: string (Markdown format)
  expected_outcome: string
  hints: [string]
  solution: string (Markdown format)
  grading_rubric: Rubric
  time_estimate: integer (minutes)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 5. Example Entity

A Worked Example represents a step-by-step demonstration:

```yaml
Example:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  description: string
  problem_statement: string (Markdown format)
  solution_approach: string (Markdown format)
  step_by_step: [ExampleStep]
  black_box_view: string (high-level view)
  glass_box_view: string (detailed implementation)
  code_implementation: string (code block)
  visual_representation: string (Mermaid diagram)
  key_insights: [string]
  common_pitfalls: [string]
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 6. ExampleStep Entity

A step in a worked example:

```yaml
ExampleStep:
  id: UUID (primary key)
  example_id: UUID (foreign key to Example)
  step_number: integer
  title: string
  description: string (Markdown format)
  code_block: string (optional code for this step)
  visual_diagram: string (optional Mermaid diagram)
  key_concept: string
  created_at: ISO 8601 timestamp
```

### 7. Assessment Entity

An Assessment represents an evaluation component:

```yaml
Assessment:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  description: string
  type: enum (multiple_choice, short_answer, implementation, essay)
  tier: enum (tier_1_comprehension, tier_2_application, tier_3_analysis_synthesis)
  difficulty: enum (basic, intermediate, advanced)
  questions: [AssessmentQuestion]
  grading_rubric: Rubric
  time_limit: integer (minutes, optional)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 8. AssessmentQuestion Entity

A question within an assessment:

```yaml
AssessmentQuestion:
  id: UUID (primary key)
  assessment_id: UUID (foreign key to Assessment)
  question_number: integer
  question_text: string (Markdown format)
  question_type: enum (multiple_choice, true_false, short_answer, code_implementation)
  answer_choices: [AnswerChoice] (for multiple choice)
  correct_answer: string (for validation)
  explanation: string (why this is correct)
  difficulty: enum (easy, medium, hard)
  cognitive_level: enum (remember, understand, apply, analyze, evaluate, create)
  points: integer
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 9. AnswerChoice Entity

A choice in a multiple-choice question:

```yaml
AnswerChoice:
  id: UUID (primary key)
  question_id: UUID (foreign key to AssessmentQuestion)
  choice_letter: string (A, B, C, D, etc.)
  choice_text: string (Markdown format)
  is_correct: boolean
  explanation: string (why this choice is correct/incorrect)
  created_at: ISO 8601 timestamp
```

### 10. Diagram Entity

A visual aid in the textbook:

```yaml
Diagram:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  description: string
  diagram_type: enum (flowchart, sequence, class, state, architecture, system)
  mermaid_code: string (Mermaid syntax)
  alt_text: string (accessible description)
  caption: string
  position: integer (order in chapter)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 11. Citation Entity

An academic citation:

```yaml
Citation:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  authors: [string]
  journal: string
  year: integer
  doi: string (optional)
  url: string (optional)
  abstract: string
  relevance_note: string (why cited in this context)
  citation_style: string (APA, MLA, Chicago, etc.)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 12. CodeExample Entity

A runnable code example:

```yaml
CodeExample:
  id: UUID (primary key)
  chapter_id: UUID (foreign key to Chapter)
  title: string
  description: string
  language: string (python, cpp, etc.)
  code_content: string (actual code)
  setup_instructions: string (how to run)
  expected_output: string
  execution_time_limit: float (seconds)
  dependencies: [string]
  ros_package: string (if ROS-specific)
  hardware_requirements: string
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 13. Rubric Entity

A grading rubric:

```yaml
Rubric:
  id: UUID (primary key)
  entity_type: string (exercise, assessment, example, etc.)
  entity_id: UUID (foreign key to respective entity)
  criteria: [RubricCriterion]
  total_points: integer
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 14. RubricCriterion Entity

A criterion within a rubric:

```yaml
RubricCriterion:
  id: UUID (primary key)
  rubric_id: UUID (foreign key to Rubric)
  criterion_name: string
  description: string
  max_points: integer
  performance_levels:
    exceeds_expectations: string
    meets_expectations: string
    below_expectations: string
    created_at: ISO 8601 timestamp
```

## Synthetic Data Models

### 15. SyntheticDataset Entity

A collection of synthetic data generated by Isaac Sim:

```yaml
SyntheticDataset:
  id: UUID (primary key)
  name: string
  description: string
  domain: string (e.g., humanoid_locomotion, manipulation, perception)
  generation_config: IsaacSimConfig
  scene_complexity: enum (simple, moderate, complex)
  object_count_range: [integer] (min, max)
  lighting_variations: integer
  material_variations: integer
  total_samples: integer
  sensor_modalities: [string] (e.g., rgb, depth, lidar, imu)
  annotation_types: [string] (e.g., segmentation, bounding_box, pose)
  generation_date: ISO 8601 timestamp
  size_bytes: integer
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 16. IsaacSimConfig Entity

Configuration for Isaac Sim generation:

```yaml
IsaacSimConfig:
  id: UUID (primary key)
  dataset_id: UUID (foreign key to SyntheticDataset)
  scene_template: string (USD file path)
  domain_randomization:
    materials: boolean
    lighting: boolean
    geometry: boolean
    dynamics: boolean
  sensor_configurations: [SensorConfig]
  performance_targets:
    fps_target: integer
    resolution: [integer] (width, height)
  hardware_specifications:
    gpu_model: string
    cuda_version: string
    memory_gb: integer
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 17. SensorConfig Entity

Configuration for synthetic sensors:

```yaml
SensorConfig:
  id: UUID (primary key)
  config_id: UUID (foreign key to IsaacSimConfig)
  sensor_type: enum (camera, lidar, depth, imu, gps, force_torque)
  position: [float] (x, y, z)
  orientation: [float] (qx, qy, qz, qw)
  parameters: object (sensor-specific parameters)
  noise_model: NoiseModel
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 18. NoiseModel Entity

Noise model for synthetic sensors:

```yaml
NoiseModel:
  id: UUID (primary key)
  sensor_config_id: UUID (foreign key to SensorConfig)
  noise_type: enum (gaussian, uniform, salt_pepper, poisson)
  parameters: object (noise-specific parameters)
  noise_level: float (0.0 to 1.0)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 19. SyntheticSample Entity

Individual sample within a synthetic dataset:

```yaml
SyntheticSample:
  id: UUID (primary key)
  dataset_id: UUID (foreign key to SyntheticDataset)
  sample_number: integer
  sensor_data: [SensorData]
  ground_truth: GroundTruth
  metadata: object (generation parameters, randomization settings)
  file_paths: [string] (paths to actual data files)
  validation_status: enum (pending, valid, invalid)
  validation_notes: string
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 20. SensorData Entity

Individual sensor data within a sample:

```yaml
SensorData:
  id: UUID (primary key)
  sample_id: UUID (foreign key to SyntheticSample)
  sensor_type: string
  data_format: string (e.g., png, npy, csv, bag)
  file_path: string
  timestamp: ISO 8601 timestamp
  frame_id: string
  sensor_pose: Pose
  quality_metrics: object (SNR, resolution, etc.)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 21. GroundTruth Entity

Ground truth data for synthetic samples:

```yaml
GroundTruth:
  id: UUID (primary key)
  sample_id: UUID (foreign key to SyntheticSample)
  robot_poses: [Pose] (for all robots in scene)
  object_poses: [Pose] (for all objects in scene)
  joint_states: [JointState] (for articulated objects)
  semantic_annotations: SemanticAnnotation
  depth_ground_truth: string (file path to depth GT)
  optical_flow: string (file path to optical flow GT)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 22. Pose Entity

6D pose representation:

```yaml
Pose:
  id: UUID (primary key)
  position: [float] (x, y, z)
  orientation: [float] (qx, qy, qz, qw)
  frame_id: string
  timestamp: ISO 8601 timestamp
  created_at: ISO 8601 timestamp
```

### 23. JointState Entity

Joint state information:

```yaml
JointState:
  id: UUID (primary key)
  entity_id: string (robot/object identifier)
  joint_names: [string]
  joint_positions: [float]
  joint_velocities: [float]
  joint_efforts: [float]
  timestamp: ISO 8601 timestamp
  created_at: ISO 8601 timestamp
```

### 24. SemanticAnnotation Entity

Semantic annotation information:

```yaml
SemanticAnnotation:
  id: UUID (primary key)
  ground_truth_id: UUID (foreign key to GroundTruth)
  instance_ids: [integer] (mapping from pixel to instance)
  class_labels: [string] (mapping from class ID to label)
  instance_info: [InstanceInfo]
  segmentation_mask_path: string (file path)
  created_at: ISO 8601 timestamp
  updated_at: ISO 8601 timestamp
```

### 25. InstanceInfo Entity

Information about individual instances in semantic data:

```yaml
InstanceInfo:
  id: UUID (primary key)
  annotation_id: UUID (foreign key to SemanticAnnotation)
  instance_id: integer
  class_id: integer
  class_name: string
  bounding_box: [float] (x_min, y_min, x_max, y_max)
  center_point: [float] (x, y)
  pixel_count: integer
  created_at: ISO 8601 timestamp
```

## Relationships

### Textbook Relationships
- Textbook (1) → (0..*) Module
- Module (1) → (0..*) Chapter
- Chapter (1) → (0..*) Exercise
- Chapter (1) → (0..*) Example
- Chapter (1) → (0..*) Assessment
- Chapter (1) → (0..*) Diagram
- Chapter (1) → (0..*) Citation
- Chapter (1) → (0..*) CodeExample
- Example (1) → (0..*) ExampleStep
- Assessment (1) → (0..*) AssessmentQuestion
- AssessmentQuestion (1) → (0..*) AnswerChoice
- Rubric (1) → (0..*) RubricCriterion

### Synthetic Data Relationships
- SyntheticDataset (1) → (0..*) IsaacSimConfig
- IsaacSimConfig (1) → (0..*) SensorConfig
- SensorConfig (1) → (0..*) NoiseModel
- SyntheticDataset (1) → (0..*) SyntheticSample
- SyntheticSample (1) → (0..*) SensorData
- SyntheticSample (1) → (1) GroundTruth
- GroundTruth (1) → (0..*) SemanticAnnotation
- SemanticAnnotation (1) → (0..*) InstanceInfo

## Validation Rules

### Textbook Content Validation
1. **Learning Objectives**: Each chapter must have 3-7 learning objectives
2. **Pedagogical Compliance**: Each chapter must implement all 10 Constitution pedagogical principles
3. **Content Completeness**: Chapters must include theory, practice, exercises, examples, and assessments
4. **Code Validation**: All code examples must be syntactically correct and include setup instructions
5. **Accessibility**: All diagrams must have alt-text and proper captions

### Synthetic Data Validation
1. **Completeness**: Each sample must have corresponding sensor data for all configured sensors
2. **Consistency**: Ground truth poses must be consistent across different sensor views
3. **Quality**: Data must meet minimum quality thresholds (SNR, resolution, etc.)
4. **Annotation Accuracy**: Semantic annotations must be pixel-perfect
5. **Domain Coverage**: Dataset must adequately cover the intended domain

## Indexes

### Primary Indexes
- Textbook.id (unique)
- Module.id (unique)
- Chapter.id (unique)
- SyntheticDataset.id (unique)
- SyntheticSample.id (unique)

### Secondary Indexes
- Chapter.module_id (for module lookup)
- Chapter.learning_objectives (for objective-based search)
- SyntheticSample.dataset_id (for dataset lookup)
- SensorData.sample_id (for sample lookup)
- Citation.chapter_id (for chapter-based citation lookup)

## Schema Evolution Guidelines

### Versioning Strategy
- Major version increments for breaking changes to primary entities
- Minor version increments for new optional fields or entities
- Patch version increments for schema corrections or index optimizations

### Migration Strategy
- Maintain backward compatibility for 2 major versions
- Provide automated migration scripts for schema updates
- Preserve data integrity during migrations
- Document all breaking changes with clear upgrade paths

This data model provides a comprehensive foundation for the Physical AI & Humanoid Robotics textbook generation system, supporting both the content generation process and the synthetic data requirements for training and validation.