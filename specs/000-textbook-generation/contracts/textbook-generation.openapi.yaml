openapi: 3.0.3
info:
  title: Physical AI & Humanoid Robotics Textbook Generation API
  description: API for generating educational content for humanoid robotics textbooks
  version: 1.0.0
  contact:
    name: Textbook Generation Team
    email: textbook-gen@nvidia.com
servers:
  - url: http://localhost:8080
    description: Local development server
  - url: https://textbook-gen-api.nvidia.com
    description: Production server

paths:
  /api/v1/textbook:
    post:
      summary: Generate a complete textbook
      description: Creates a new textbook with specified modules and chapters
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TextbookGenerationRequest'
      responses:
        '201':
          description: Textbook generation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerationResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/module:
    post:
      summary: Generate a module
      description: Creates a new module with specified chapters
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ModuleGenerationRequest'
      responses:
        '201':
          description: Module generation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerationResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/chapter:
    post:
      summary: Generate a chapter
      description: Creates a new chapter with pedagogical elements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChapterGenerationRequest'
      responses:
        '201':
          description: Chapter generation initiated successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerationResponse'
        '400':
          description: Invalid request parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/validate/chapter:
    post:
      summary: Validate chapter content
      description: Validates a chapter against pedagogical principles and technical requirements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChapterValidationRequest'
      responses:
        '200':
          description: Chapter validation completed
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationResponse'
        '400':
          description: Invalid chapter content
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/synthetic-data/generate:
    post:
      summary: Generate synthetic training data
      description: Creates synthetic data using Isaac Sim for humanoid robotics training
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SyntheticDataRequest'
      responses:
        '201':
          description: Synthetic data generation initiated
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GenerationResponse'
        '400':
          description: Invalid generation parameters
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

  /api/v1/synthetic-data/status/{job_id}:
    get:
      summary: Get synthetic data generation status
      description: Retrieves the status of a synthetic data generation job
      parameters:
        - name: job_id
          in: path
          required: true
          schema:
            type: string
            format: uuid
          description: ID of the generation job
      responses:
        '200':
          description: Job status retrieved successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SyntheticDataJobStatus'
        '404':
          description: Job not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Error'

components:
  schemas:
    TextbookGenerationRequest:
      type: object
      required:
        - title
        - modules
        - pedagogical_principles
      properties:
        title:
          type: string
          description: Title of the textbook
          example: "Physical AI & Humanoid Robotics"
        subtitle:
          type: string
          description: Subtitle of the textbook
          example: "From ROS 2 Basics to Autonomous Humanoids"
        modules:
          type: array
          items:
            $ref: '#/components/schemas/ModuleSpec'
          description: List of modules to include in the textbook
        pedagogical_principles:
          type: array
          items:
            type: string
          description: List of pedagogical principles to enforce
          example: ["clear_objectives", "theory_practice_dual_track", "active_learning", "worked_examples", "tiered_assessments", "visual_aids", "inclusive_examples", "progressive_scaffolding", "real_world_citations", "runnable_code"]
        target_audience:
          type: string
          description: Target audience for the textbook
          example: "University students and researchers"
        estimated_completion_time:
          type: integer
          description: Estimated time to complete the textbook in hours
          example: 120
        license:
          type: string
          description: License for the textbook content
          example: "CC BY-SA 4.0"
        accessibility_compliance:
          type: string
          description: Accessibility compliance level
          example: "WCAG 2.1 AA"

    ModuleSpec:
      type: object
      required:
        - title
        - position
        - chapters
      properties:
        title:
          type: string
          description: Title of the module
          example: "The Robotic Nervous System (ROS 2)"
        position:
          type: integer
          description: Position of the module in the textbook (1-based)
          example: 1
        chapters:
          type: array
          items:
            $ref: '#/components/schemas/ChapterSpec'
          description: List of chapters in this module
        description:
          type: string
          description: Brief description of the module
          example: "Foundational concepts of ROS 2 for humanoid robotics"
        estimated_completion_time:
          type: integer
          description: Estimated time to complete the module in hours
          example: 30

    ChapterSpec:
      type: object
      required:
        - title
        - position
        - learning_objectives
        - topics
      properties:
        title:
          type: string
          description: Title of the chapter
          example: "ROS 2 and Embodied Control"
        position:
          type: integer
          description: Position of the chapter in the module (1-based)
          example: 1
        learning_objectives:
          type: array
          items:
            type: string
          description: List of learning objectives for the chapter
          example: ["Understand ROS 2 architecture", "Implement basic node communication", "Configure robot controllers"]
        topics:
          type: array
          items:
            type: string
          description: List of topics covered in the chapter
          example: ["ROS 2 architecture", "Node communication", "Robot control"]
        difficulty_level:
          type: string
          enum: [beginner, intermediate, advanced]
          description: Difficulty level of the chapter
        estimated_reading_time:
          type: integer
          description: Estimated reading time in minutes
          example: 45
        include_code_examples:
          type: boolean
          description: Whether to include code examples in this chapter
          default: true
        include_diagrams:
          type: boolean
          description: Whether to include diagrams in this chapter
          default: true
        include_assessments:
          type: boolean
          description: Whether to include assessments in this chapter
          default: true

    ModuleGenerationRequest:
      type: object
      required:
        - textbook_id
        - module_spec
      properties:
        textbook_id:
          type: string
          format: uuid
          description: ID of the parent textbook
        module_spec:
          $ref: '#/components/schemas/ModuleSpec'
        generation_parameters:
          $ref: '#/components/schemas/GenerationParameters'

    ChapterGenerationRequest:
      type: object
      required:
        - module_id
        - chapter_spec
      properties:
        module_id:
          type: string
          format: uuid
          description: ID of the parent module
        chapter_spec:
          $ref: '#/components/schemas/ChapterSpec'
        generation_parameters:
          $ref: '#/components/schemas/GenerationParameters'

    GenerationParameters:
      type: object
      properties:
        quality_level:
          type: string
          enum: [standard, high, premium]
          description: Quality level for content generation
          default: high
        domain_randomization:
          type: boolean
          description: Whether to apply domain randomization to synthetic elements
          default: true
        hardware_acceleration:
          type: boolean
          description: Whether to use hardware acceleration for synthetic data
          default: true
        target_platform:
          type: string
          description: Target platform for code examples
          example: "ROS 2 Humble on NVIDIA Jetson"
        performance_targets:
          type: object
          properties:
            max_code_execution_time:
              type: number
              description: Maximum execution time for code examples in seconds
              example: 2.0
            min_fps:
              type: integer
              description: Minimum frames per second for synthetic data generation
              example: 30

    ChapterValidationRequest:
      type: object
      required:
        - chapter_content
        - validation_rules
      properties:
        chapter_content:
          type: string
          description: Markdown content of the chapter to validate
        validation_rules:
          type: array
          items:
            type: string
          description: List of validation rules to apply
          example: ["pedagogical_principles", "code_syntax", "accessibility", "technical_accuracy"]
        target_pedagogical_principles:
          type: array
          items:
            type: string
          description: List of pedagogical principles to validate against

    SyntheticDataRequest:
      type: object
      required:
        - scene_config
        - output_config
        - sample_count
      properties:
        scene_config:
          $ref: '#/components/schemas/SceneConfig'
        output_config:
          $ref: '#/components/schemas/OutputConfig'
        sample_count:
          type: integer
          description: Number of samples to generate
          example: 10000
        domain_randomization:
          $ref: '#/components/schemas/DomainRandomizationConfig'
        hardware_config:
          $ref: '#/components/schemas/HardwareConfig'

    SceneConfig:
      type: object
      required:
        - scene_type
        - robot_model
        - environment
      properties:
        scene_type:
          type: string
          enum: [indoor, outdoor, laboratory, warehouse, humanoid_specific]
          description: Type of scene to generate
        robot_model:
          type: string
          description: URDF/USD model of the humanoid robot
          example: "simple_humanoid.urdf"
        environment:
          type: string
          description: Environment description or USD path
          example: "isaac_sim_environments/humanoid_lab.usd"
        objects:
          type: array
          items:
            $ref: '#/components/schemas/ObjectConfig'
          description: List of objects to include in the scene
        lighting:
          $ref: '#/components/schemas/LightingConfig'

    ObjectConfig:
      type: object
      required:
        - name
        - type
      properties:
        name:
          type: string
          description: Name of the object
          example: "red_ball"
        type:
          type: string
          enum: [sphere, cube, cylinder, capsule, mesh]
          description: Type of primitive or mesh
        position:
          type: array
          items:
            type: number
          minItems: 3
          maxItems: 3
          description: Position in [x, y, z] format
          example: [2.0, 1.0, 0.1]
        scale:
          type: array
          items:
            type: number
          minItems: 3
          maxItems: 3
          description: Scale in [x, y, z] format
          example: [1.0, 1.0, 1.0]
        material:
          $ref: '#/components/schemas/MaterialConfig'

    MaterialConfig:
      type: object
      properties:
        albedo:
          type: array
          items:
            type: number
          minItems: 3
          maxItems: 3
          description: Albedo color in RGB format
          example: [0.8, 0.2, 0.2]
        roughness:
          type: number
          description: Roughness value (0.0 to 1.0)
          example: 0.5
        metallic:
          type: number
          description: Metallic value (0.0 to 1.0)
          example: 0.0

    LightingConfig:
      type: object
      properties:
        sun_intensity:
          type: number
          description: Intensity of the directional light
          example: 1000.0
        dome_intensity:
          type: number
          description: Intensity of the dome light
          example: 1.5
        color_temperature:
          type: number
          description: Color temperature in Kelvin
          example: 6500.0

    OutputConfig:
      type: object
      required:
        - resolution
        - data_types
      properties:
        resolution:
          type: array
          items:
            type: integer
          minItems: 2
          maxItems: 2
          description: Resolution in [width, height] pixels
          example: [1920, 1080]
        data_types:
          type: array
          items:
            type: string
          description: Types of data to generate
          example: ["rgb", "depth", "semantic_segmentation", "instance_segmentation"]
        format:
          type: string
          enum: [png, jpeg, exr, nrrd]
          description: Output format for images
        compression:
          type: string
          enum: [lossless, lossy_medium, lossy_high]
          description: Compression level for output

    DomainRandomizationConfig:
      type: object
      properties:
        materials:
          type: boolean
          description: Randomize material properties
          default: true
        lighting:
          type: boolean
          description: Randomize lighting conditions
          default: true
        geometry:
          type: boolean
          description: Randomize object positions and scales
          default: true
        dynamics:
          type: boolean
          description: Randomize physical properties
          default: true
        material_range:
          $ref: '#/components/schemas/RangeConfig'
        lighting_range:
          $ref: '#/components/schemas/RangeConfig'
        geometry_range:
          $ref: '#/components/schemas/RangeConfig'

    RangeConfig:
      type: object
      properties:
        min:
          type: number
          description: Minimum value for randomization
        max:
          type: number
          description: Maximum value for randomization

    HardwareConfig:
      type: object
      required:
        - gpu_id
      properties:
        gpu_id:
          type: integer
          description: GPU ID to use for generation
          example: 0
        cuda_version:
          type: string
          description: CUDA version to use
          example: "12.0"
        memory_gb:
          type: integer
          description: Minimum GPU memory in GB
          example: 24

    GenerationResponse:
      type: object
      required:
        - job_id
        - status
        - created_at
      properties:
        job_id:
          type: string
          format: uuid
          description: Unique identifier for the generation job
        status:
          type: string
          enum: [queued, processing, completed, failed]
          description: Current status of the generation job
        created_at:
          type: string
          format: date-time
          description: Timestamp when the job was created
        estimated_completion_time:
          type: string
          format: date-time
          description: Estimated completion time for the job
        output_path:
          type: string
          description: Path where the generated content will be stored

    ValidationResponse:
      type: object
      required:
        - validation_id
        - results
        - status
      properties:
        validation_id:
          type: string
          format: uuid
          description: Unique identifier for the validation
        results:
          type: array
          items:
            $ref: '#/components/schemas/ValidationResult'
        status:
          type: string
          enum: [pass, partial_pass, fail]
          description: Overall validation status
        summary:
          type: string
          description: Summary of validation results
        recommendations:
          type: array
          items:
            type: string
          description: Recommendations for improving content quality

    ValidationResult:
      type: object
      required:
        - check_name
        - status
        - details
      properties:
        check_name:
          type: string
          description: Name of the validation check
          example: "pedagogical_principles_compliance"
        status:
          type: string
          enum: [pass, fail, warning]
          description: Status of the validation check
        details:
          type: string
          description: Detailed information about the validation result
        severity:
          type: string
          enum: [low, medium, high, critical]
          description: Severity level of any issues found

    SyntheticDataJobStatus:
      type: object
      required:
        - job_id
        - status
        - progress
      properties:
        job_id:
          type: string
          format: uuid
          description: Unique identifier for the synthetic data job
        status:
          type: string
          enum: [queued, initializing, generating, post_processing, completed, failed, cancelled]
          description: Current status of the job
        progress:
          type: number
          description: Progress percentage (0.0 to 100.0)
          example: 75.5
        samples_generated:
          type: integer
          description: Number of samples generated so far
          example: 7550
        total_samples:
          type: integer
          description: Total number of samples to generate
          example: 10000
        estimated_remaining_time:
          type: string
          description: Estimated remaining time in HH:MM:SS format
          example: "00:15:30"
        output_directory:
          type: string
          description: Directory where synthetic data is being saved
        performance_metrics:
          $ref: '#/components/schemas/PerformanceMetrics'

    PerformanceMetrics:
      type: object
      properties:
        fps_current:
          type: number
          description: Current frames per second
          example: 28.5
        fps_average:
          type: number
          description: Average frames per second over the session
          example: 30.2
        gpu_utilization:
          type: number
          description: Current GPU utilization percentage
          example: 85.0
        memory_usage_gb:
          type: number
          description: Current GPU memory usage in GB
          example: 18.2
        generation_rate_samples_per_minute:
          type: number
          description: Rate of sample generation per minute
          example: 1250.0

    Error:
      type: object
      required:
        - error_code
        - message
      properties:
        error_code:
          type: string
          description: Machine-readable error code
          example: "INVALID_PARAMETER"
        message:
          type: string
          description: Human-readable error message
          example: "Invalid parameter value provided"
        details:
          type: object
          description: Additional error details
        timestamp:
          type: string
          format: date-time
          description: Time when the error occurred

tags:
  - name: textbook
    description: Operations related to textbook generation
  - name: module
    description: Operations related to module generation
  - name: chapter
    description: Operations related to chapter generation and validation
  - name: synthetic-data
    description: Operations related to synthetic data generation
  - name: validation
    description: Operations related to content validation

security:
  - bearerAuth: []
  - apiKey: []

securityDefinitions:
  bearerAuth:
    type: http
    scheme: bearer
    bearerFormat: JWT
  apiKey:
    type: apiKey
    in: header
    name: X-API-Key